pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
	p = {
		x = 7 * 8,
		y = 11 * 8,
		speed = 1,
		flipped = false
	}
	truck = {
		x = 3*8,
		y = 0,
		w = 7,
		h = 8
	}
	truck.grid = create_truck_grid()
end

function _update60()
	move_player()
end

function _draw()
	cls()
	camera(p.x - 60, p.y - 60)
	map(0, 0, 0, 0, 17, 17)

 -- dessin du camion
 for i = 1, #(truck.grid) do 
		for j = 1, #(truck.grid[i]) do
		 if truck.grid[i][j] == false then
			 spr(2, truck.x + i *8 - 8, truck.y + j*8 - 8)
			else
				spr(0, truck.x + i *8 - 8, truck.y + j*8 - 8)
			end
		end
	end
	
	
	-- dessin du joueur
	palt(11, true)
	palt(0, false)	
	spr(1, p.x, p.y, 1, 1, p.flipped)
end
-->8
-- player

function move_player()
 local dx, dy = p.x, p.y
 
	if (btn(⬆️)) dy -= p.speed
	if (btn(⬇️)) dy += p.speed
	if (btn(⬅️)) then
		dx -= p.speed
		p.flipped = true
	end
	if (btn(➡️)) then
		dx += p.speed
		p.flipped = false
	end
	
	if (is_colliding(dx, p.y)) dx = p.x
	if (is_colliding(p.x, dy)) dy = p.y

	p.x = dx
	p.y = dy  
end
-->8
-- utils

function is_colliding(x, y)
	return is_collidable(mget(x / 8, (y + 7) / 8))
					or is_collidable(mget((x + 7) / 8, (y + 7) / 8))
					or is_collidable(mget((x + 7) / 8, y / 8))
					or is_collidable(mget((x / 8), y / 8))
end

function is_collidable(tile)
	return fget(tile, 0)
end
-->8
-- truck

function create_truck_grid()
	local grid = {}
	for i = 1, truck.w do 
		grid[i] = {}
		for j = 1, truck.h do
			grid[i][j] = false
		end
	end
	return grid
end

function can_put_shape(x, y, shape)
	-- todo: determiner quand on peut pas
	
	-- c'est bon !
	return true
end
__gfx__
00000000bbaaaaab5545554588488488000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbf0f0bb5555555444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700bb44e4bb4555555584884884000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000bba55aab5555555544444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000bb7557bb5555555488488488000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700bb9999bb4555555544444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb9999bb5555555548848848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb4bb4bb5545545544444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999999999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999cccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeecccccccccccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030000000000000003030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
